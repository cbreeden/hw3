# Exercise 8

Using the next reaction method, simulate and plot a single trajectory of the model in Example 6.3 with $\kappa_1 = 200$, $\kappa_2 = 10$, $d_M = 25$, $d_p = 1$, an initial condition of 1 gene, 10 mRNA, and 50 protein molecules, and a terminal time of $T = 8$.

This model yields the four reaction vectors:
$$
\xi_1 = (0,1,0),\ \xi_2 = (0,0,1),\ \xi_3 = (0,-1,0),\ \xi_4 = (0,0,-1).
$$

# Exercise 11

Let

$$
\xi_1 = (-1, 1, 0) \ \text{and}\ \xi_2 = (0, -1, 1),
$$

and let $X^\theta_n$ be a discrete time Markov chain on $\mathbb{Z}^3_{\geq 0}$ with the following transition probabilities:

\begin{align}
p_{\vec x, \vec x + \xi_1} &= \frac{\theta xy}{\theta xy + y} \\
p_{\vec x, \vec x + \xi_2} &= 1 - p_1(x,y,z),
\end{align}

Assume that $X^\theta_0 = (100, 5, 0)$ and $\theta = 0.05$.  Let $f(X^\theta) = \left(X^\theta_1\right)_{100}$; that is the first component of the process after 100 steps.  We estimate $\frac{d}{d\theta} E\left[f(X^\theta)\right]$ using a number of different techniques.

## Finite Difference Method

In this problem, we employ a centered finite difference method using the estimator

$$
\hat \mu^{\theta, h}_k
      = \frac{f(X^{\theta + h/2}_k) - f(X^{\theta - h/2}_k)}{h}.
$$

In an attempt to reduce the variance, we employ the common random variables technique; in which we will use the same sequence of uniform random variables when generating relizations $X^{\theta + h/2}_k$ and $X^{\theta - h/2}_k$.  We took $n = 10,000$ samples and obtained the following results for various $h$.


   h       $\hat \mu^{\theta, h}$        $\sigma^2$        Confidence
-------  --------------------------    ---------------    ------------
0.01      -306.59                         18,230.86          2.56
0.005     -304.76                         36,782.56          3.76
0.001     -296.61                        215,947.83          9.11
0.0005    -298.46                        507,757.71         13.97

## Likelihood Ratio Method

For likelihood ratio method, we took $n = 100,000$ samples.

   $\hat Y^{\theta}$            $\sigma^2$          Confidence
----------------------     ----------------     ----------------
      -331.29                  564,0541.81            46.55

While emplying a control variate with the weight function obtained using the Likelihood Ratio method, we had a dramatic reduction in variance.

  $\hat Y^\theta$              $\sigma^2$          Confidence
----------------------    ------------------    -----------------
      -302.56                   190,379.28             8.55